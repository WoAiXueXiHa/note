[TOC]



# 链表带环，`fast`走两步，`slow`走一步一定能追上吗？

`fast`先进环，`slow`后进环，假设`slow`进环时与`fast`距离为$N$

每次运动，二者距离减一

这是二者距离变化：

![image-20250901171328448](C:\Users\hp\AppData\Roaming\Typora\typora-user-images\image-20250901171328448.png)

所以`fast`走两步，`slow`一定能追上

# 链表带环，`fast`走三步，`slow`走一步一定能追上吗？

`fast`先进环，`slow`后进环，假设`slow`进环时与`fast`距离为$N$

每次运动，二者距离减二

这是二者距离变化：

![image-20250901171816365](C:\Users\hp\AppData\Roaming\Typora\typora-user-images\image-20250901171816365.png)

假设环长为$C$，若$C - 1$为偶数，下一轮就追上了，若$C - 1$为奇数，则仍需分析

考略一下：永远追不上的条件：$C - 1$为奇数并且$N$为奇数

这个条件能成立吗？

我们先来看一道题铺垫一下：

[142. 环形链表 II - 力扣（LeetCode）](https://leetcode.cn/problems/linked-list-cycle-ii/)

假设链表头到环的入口点距离为$L$，环长$C$，入口点到相遇点距离$X$ 

此时`fast`走两步，`slow`走一步

相遇时：

`slow` 走了$L+X$，

`fast`已经绕环$x$圈，`fast`走了$L+xC+X$

`fast`走两步，`slow`走一步，二者可以得到距离关系：

$L+xC+X= 2(L+X)$

化简可得：

$L = (x-1)C + (C-X)$

![image-20250901173940300](C:\Users\hp\AppData\Roaming\Typora\typora-user-images\image-20250901173940300.png)

得到结论：**一个指针从链表头开始走，一个指针从相遇点开始走，最终会在环的入口点相遇（两个指针走一样的步长）**

所以，对于这道题目，先找相遇点，然后创建两个新的指针，一个从链表头开始，一个从相遇点开始，同时走，相遇的节点就是入口点

```c++
class Solution {
public:
    ListNode *detectCycle(ListNode *head) {
        // 处理空链表
        if(head == nullptr) return nullptr;
        // 创建快慢指针找相遇点
        ListNode* fast = head, *slow = head;
        // 相遇点
        ListNode* meet = nullptr;
        // 找相遇点
        while(fast && fast->next){
            slow = slow->next;
            fast = fast->next->next;
            if(fast == slow){
                // 一个从链表头 一个从相遇点
                meet = slow;
                while(meet != head){
                    meet = meet->next;
                    head = head->next;
                }
                return meet;
            }
        }
        return nullptr;
    }
};
```

现在回到原来的问题，

## `fast`走三步，`slow`走一步，永远追不上的条件：$C - 1$为奇数并且$N$为奇数成立吗？

假设链表头到入口点距离$L$，环长$C$，`slow`进环时，距离`fast`为$N$，此时`fast`已经走了$x$圈，并多走了$C-N$

根据数量关系可得：

$3L = L + xC + C-N$	

化简得：

$2L = (x+1)C - N$

$C - 1$为奇数，那么$C$就是偶数，任意数乘以偶数还是偶数，$N$为奇数

根据等式： 偶数 = 偶数 - 奇数    这是个错误结论！所以我们之前的设想：永远追不上的猜测是错误的，`fast`走三步，`slow`走一步也可以追上！